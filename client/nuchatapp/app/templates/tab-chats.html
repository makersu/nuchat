<ion-view cache-view="false" title="聊天">
	<ion-nav-buttons side="right">
    <button class="button button-icon ion-more" ng-click="goToCreateRoom()"></button>
  </ion-nav-buttons>
  <ion-content class="has-header">
    <ion-refresher
      pulling-text="Pull to refresh..."
      on-refresh="doRefresh()">
    </ion-refresher>
    <ion-list>
      <ion-item class="item-avatar" ng-repeat="room in availableRooms track by $index" type="item-text-wrap" ng-click="goToRoom(room.id)">
        <img src="{{ room.profile || 'images/profile.png' }}">
        {{room.name}}
        <p>{{ room.unreadMessages[room.unreadMessages.length-1].text || room.messages[room.messages.length-1].text | brief }}</p>
        <span class="timestamp">{{ room.unreadMessages[room.unreadMessages.length-1].created || room.messages[room.messages.length-1].created | amChatCalendar }}</span>
        <span class="badge badge-assertive" ng-if="room.unreadMessages.length">{{ room.unreadMessages.length }}</span>
      </ion-item>
    </ion-list>
  </ion-content>
</ion-view>